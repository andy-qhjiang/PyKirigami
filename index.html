<!doctype html><html lang="en"> <head> <meta charset="utf-8" /> <title>PyKirigami Viewer</title> <meta name="viewport" content="width=device-width, initial-scale=1" /> <style> html, body { height: 100%; margin: 0; overflow: hidden; background: #f7f7f7; } canvas { display: block; } #msg { position: absolute; top: 8px; left: 8px; padding: 6px 8px; background: #0008; color: #fff; font: 12px/1.4 monospace; border-radius: 4px; } </style> <!-- Polyfill so import maps work everywhere (Safari/Firefox too) --> <script async src="https://unpkg.com/es-module-shims@1.10.0/dist/es-module-shims.js"></script> <!-- Import map: resolve 'three' and addons --> <script type="importmap"> { "imports": { "three": "https://unpkg.com/three@0.158.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.158.0/examples/jsm/" } } </script> </head> <body> <div id="msg">Loadingâ€¦</div> <script type="module"> import * as THREE from 'three'; import { OrbitControls } from 'three/addons/controls/OrbitControls.js'; import { MTLLoader } from 'three/addons/loaders/MTLLoader.js'; import { OBJLoader } from 'three/addons/loaders/OBJLoader.js';
// Config
const params = new URLSearchParams(location.search);
// Change default below to one of your actual files in output/, e.g. scene_1756683360
const SCENE_NAME = params.get('scene') || 'scene_1756683360';
const ASSET_PATH = './output/';

const msg = document.getElementById('msg');
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xf7f7f7);

const camera = new THREE.PerspectiveCamera(50, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(1.0, 1.0, 1.2);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(Math.min(devicePixelRatio, 2));
document.body.appendChild(renderer.domElement);

const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

scene.add(new THREE.HemisphereLight(0xffffff, 0x444444, 0.8));
const dir = new THREE.DirectionalLight(0xffffff, 0.6);
dir.position.set(2, 2, 2);
scene.add(dir);

// Optional grid (Y-up)
const grid = new THREE.GridHelper(1.0, 20, 0xcccccc, 0xeeeeee);
grid.position.y = -0.001;
scene.add(grid);

// Loaders with error logging
const mtlLoader = new MTLLoader();
mtlLoader.setPath(ASSET_PATH);
mtlLoader.setResourcePath(ASSET_PATH); // if MTL references textures

mtlLoader.load(`${SCENE_NAME}.mtl`, (materials) => {
materials.preload();
const objLoader = new OBJLoader();
objLoader.setMaterials(materials);
objLoader.setPath(ASSET_PATH);

objLoader.load(`${SCENE_NAME}.obj`, (obj) => {
// Convert PyBullet Z-up -> three.js Y-up
obj.rotation.x = -Math.PI / 2;

// Center and scale to fit
const box = new THREE.Box3().setFromObject(obj);
const size = new THREE.Vector3(); box.getSize(size);
const center = new THREE.Vector3(); box.getCenter(center);
const maxDim = Math.max(size.x, size.y, size.z) || 1.0;
obj.position.sub(center);
obj.scale.setScalar(1.0 / maxDim);

scene.add(obj);
controls.update();
msg.textContent = `Loaded: ${SCENE_NAME}`;
}, undefined, (err) => {
console.error('OBJ load error:', err);
msg.textContent = 'OBJ load error (see console)';
});
}, undefined, (err) => {
console.error('MTL load error:', err);
msg.textContent = 'MTL load error (see console)';
});

// Resize + render
window.addEventListener('resize', () => {
camera.aspect = innerWidth/innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(innerWidth, innerHeight);
});
renderer.setAnimationLoop(() => {
controls.update();
renderer.render(scene, camera);
});
</script>

</body> </html>
